!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Dialog=t()}(this,function(){"use strict";function e(e){var t='<div class="'+e.elementCls.el+'"> ';if(e.mask&&(t+=' <div class="'+e.elementCls.mask+'"></div> '),t+=' <div class="'+e.elementCls.wrap+'" style="position:absolute;top:'+e.top+'px;"> ',e.title&&(t+=' <div class="'+e.elementCls.head+'"> '+e.title+" ",e.showClose&&(t+=' <span class="'+e.elementCls.close+'" et="click:closeDialog">&#10005;</span> '),t+=" </div> "),t+=" ",e.content&&(t+=' <div class="'+e.elementCls.body+'">'+e.content+"</div> "),t+=" ",e.btns.length>0){t+=' <div class="'+e.elementCls.foot+'"> ';var i=e.btns;if(i)for(var o,n=-1,s=i.length-1;n<s;)o=i[n+=1],t+=' <span class="'+e.elementCls.btn+" "+(o.css?o.css:"")+'" et="click:btnCallback'+n+'">'+o.text+"</span> ";t+=" </div> "}return t+=" </div></div>"}function t(){}var i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),n={title:"标题",visible:!0,showClose:!0,content:"内容",btns:[],mask:!0,onClose:t,onShow:t,onDispose:t,elementCls:{el:"mod-dialog",mask:"overlay",wrap:"dialog-wrap",close:"close-btn",head:"dialog-head",body:"dialog-body",foot:"dialog-foot",btn:"dialog-btn"}};return function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.evtHandler={},this.options=$.extend(!0,{},n,e),this.dialogNode=null,this._init(),this._bindEvent(),this.options.visible&&this.show()}return o(t,[{key:"_init",value:function(){var t=this,i=this.options,o=window.innerHeight;i.btns.forEach(function(e,i){t.evtHandler["btnCallback"+i]=e.callback}),this.dialogNode=$(e(i)),this.dialogNode.css({display:"none",visibility:"hidden"}),$("body").append(this.dialogNode);var n=$("."+i.elementCls.wrap);n[0].scrollHeight<o&&n.css({position:"fixed",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)","-webkit-transform":"translateX(-50%) translateY(-50%)"}),this.dialogNode.css({visibility:"visible"}),this.registerHandler("closeDialog",this.close.bind(this))}},{key:"show",value:function(){this.options.onShow(this.dialogNode),this.dialogNode.css({display:"block"})}},{key:"close",value:function(){this.options.onClose(),this.dialogNode.css({display:"none"})}},{key:"dispose",value:function(){if(this.dialogNode){var e=this.options;this.dialogNode.off("click"),this.dialogNode.remove(),this.dialogNode=null,e.onDispose(),this.evtHandler={}}}},{key:"updateContent",value:function(e){var t=this.options;this.dialogNode.find("."+t.elementCls.body).html(e)}},{key:"registerHandler",value:function(e,t){if(this.evtHandler[e])throw new Error("事件处理函数已经存在");this.evtHandler[e]=t}},{key:"_bindEvent",value:function(){var e=this;this.dialogNode.on("click",function(t){var i=(t=t||window.event).target.tagName,o=$(t.target),n=o.attr("et");if(!n){for(;o[0]&&o[0]!==e.dialogNode&&!n;)n=(o=o.parent()).attr("et");if(!n)return}"A"!==i&&t.stopPropagation(),0===n.indexOf(t.type)&&e.evtHandler[n.split(":")[1]](o,t)})}}]),t}()});
