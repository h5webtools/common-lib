!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("crypto")):"function"==typeof define&&define.amd?define(["crypto"],t):e.LibQcloudUpload=t(e.crypto)}(this,function(i){"use strict";i=i&&"default"in i?i.default:i;var r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(e,t){return e(t={exports:{}},t.exports),t.exports}var o=e(function(e,t){function b(e,t,n){var r,o,a="";for(t/=8,r=0;r<t;r+=1)o=e[r>>>2]>>>8*(3+r%4*-1),a+="0123456789abcdef".charAt(o>>>4&15)+"0123456789abcdef".charAt(15&o);return n.outputUpper?a.toUpperCase():a}function w(e,t,n){var r,o,a,i="",s=t/8;for(r=0;r<s;r+=3)for(o=r+1<s?e[r+1>>>2]:0,a=r+2<s?e[r+2>>>2]:0,a=(e[r>>>2]>>>8*(3+r%4*-1)&255)<<16|(o>>>8*(3+(r+1)%4*-1)&255)<<8|a>>>8*(3+(r+2)%4*-1)&255,o=0;o<4;o+=1)i+=8*r+6*o<=t?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6*(3-o)&63):n.b64Pad;return i}function S(e,t){var n,r,o="",a=t/8;for(n=0;n<a;n+=1)r=e[n>>>2]>>>8*(3+n%4*-1)&255,o+=String.fromCharCode(r);return o}function x(e,t){var n,r=t/8,o=new ArrayBuffer(r);for(n=0;n<r;n+=1)o[n]=e[n>>>2]>>>8*(3+n%4*-1)&255;return o}function T(e){var t={outputUpper:!1,b64Pad:"=",shakeLen:-1};if(e=e||{},t.outputUpper=e.outputUpper||!1,!0===e.hasOwnProperty("b64Pad")&&(t.b64Pad=e.b64Pad),"boolean"!=typeof t.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw Error("Invalid b64Pad formatting option");return t}function C(e,f){var t;switch(f){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":t=function(e,t,n){var r,o,a,i,s,c=e.length;if(0!=c%2)throw Error("String of HEX type must be in byte increments");for(t=t||[0],s=(n=n||0)>>>3,r=0;r<c;r+=2){if(o=parseInt(e.substr(r,2),16),isNaN(o))throw Error("String of HEX type contains invalid characters");for(a=(i=(r>>>1)+s)>>>2;t.length<=a;)t.push(0);t[a]|=o<<8*(3+i%4*-1)}return{value:t,binLen:4*c+n}};break;case"TEXT":t=function(e,t,n){var r,o,a,i,s,c,u,l,p=0;if(t=t||[0],s=(n=n||0)>>>3,"UTF8"===f)for(l=3,a=0;a<e.length;a+=1)for(o=[],(r=e.charCodeAt(a))<128?o.push(r):r<2048?(o.push(192|r>>>6),o.push(128|63&r)):r<55296||57344<=r?o.push(224|r>>>12,128|r>>>6&63,128|63&r):(a+=1,r=65536+((1023&r)<<10|1023&e.charCodeAt(a)),o.push(240|r>>>18,128|r>>>12&63,128|r>>>6&63,128|63&r)),i=0;i<o.length;i+=1){for(c=(u=p+s)>>>2;t.length<=c;)t.push(0);t[c]|=o[i]<<8*(l+u%4*-1),p+=1}else if("UTF16BE"===f||"UTF16LE"===f)for(l=2,a=0;a<e.length;a+=1){for(r=e.charCodeAt(a),"UTF16LE"===f&&(r=(i=255&r)<<8|r>>>8),c=(u=p+s)>>>2;t.length<=c;)t.push(0);t[c]|=r<<8*(l+u%4*-1),p+=2}return{value:t,binLen:8*p+n}};break;case"B64":t=function(e,t,n){var r,o,a,i,s,c,u,l=0;if(-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");if(o=e.indexOf("="),e=e.replace(/\=/g,""),-1!==o&&o<e.length)throw Error("Invalid '=' found in base-64 string");for(t=t||[0],c=(n=n||0)>>>3,o=0;o<e.length;o+=4){for(s=e.substr(o,4),a=i=0;a<s.length;a+=1)i|=(r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(s[a]))<<18-6*a;for(a=0;a<s.length-1;a+=1){for(r=(u=l+c)>>>2;t.length<=r;)t.push(0);t[r]|=(i>>>16-8*a&255)<<8*(3+u%4*-1),l+=1}}return{value:t,binLen:8*l+n}};break;case"BYTES":t=function(e,t,n){var r,o,a,i,s;for(t=t||[0],a=(n=n||0)>>>3,o=0;o<e.length;o+=1)r=e.charCodeAt(o),i=(s=o+a)>>>2,t.length<=i&&t.push(0),t[i]|=r<<8*(3+s%4*-1);return{value:t,binLen:8*e.length+n}};break;case"ARRAYBUFFER":try{t=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}t=function(e,t,n){var r,o,a,i;for(t=t||[0],o=(n=n||0)>>>3,r=0;r<e.byteLength;r+=1)a=(i=r+o)>>>2,t.length<=a&&t.push(0),t[a]|=e[r]<<8*(3+i%4*-1);return{value:t,binLen:8*e.byteLength+n}};break;default:throw Error("format must be HEX, TEXT, B64, BYTES, or ARRAYBUFFER")}return t}function l(e,t){return e<<t|e>>>32-t}function p(e,t){var n=(65535&e)+(65535&t);return((e>>>16)+(t>>>16)+(n>>>16)&65535)<<16|65535&n}function f(e,t,n,r,o){var a=(65535&e)+(65535&t)+(65535&n)+(65535&r)+(65535&o);return((e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(o>>>16)+(a>>>16)&65535)<<16|65535&a}function E(e){if("SHA-1"!==e)throw Error("No SHA variants supported");return[1732584193,4023233417,2562383102,271733878,3285377520]}function F(e,t){var n,r,o,a,i,s,c,u=[];for(n=t[0],r=t[1],o=t[2],a=t[3],i=t[4],c=0;c<80;c+=1)u[c]=c<16?e[c]:l(u[c-3]^u[c-8]^u[c-14]^u[c-16],1),s=c<20?f(l(n,5),r&o^~r&a,i,1518500249,u[c]):c<40?f(l(n,5),r^o^a,i,1859775393,u[c]):c<60?f(l(n,5),r&o^r&a^o&a,i,2400959708,u[c]):f(l(n,5),r^o^a,i,3395469782,u[c]),i=a,a=o,o=l(r,30),r=n,n=s;return t[0]=p(n,t[0]),t[1]=p(r,t[1]),t[2]=p(o,t[2]),t[3]=p(a,t[3]),t[4]=p(i,t[4]),t}function n(e,t,n,r){var o;for(o=15+(t+65>>>9<<4);e.length<=o;)e.push(0);for(e[t>>>5]|=128<<24-t%32,t+=n,e[o]=4294967295&t,e[o-1]=t/4294967296|0,t=e.length,o=0;o<t;o+=16)r=F(e.slice(o,o+16),r);return r}var k,o;k=function(){function s(e){var t=e.length,n=E.type(e);return"function"!==n&&!E.isWindow(e)&&(!(1!==e.nodeType||!t)||"array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}function r(){P.addEventListener?(P.removeEventListener("DOMContentLoaded",t,!1),window.removeEventListener("load",t,!1)):(P.detachEvent("onreadystatechange",t),window.detachEvent("onload",t))}function t(){!P.addEventListener&&"load"!==event.type&&"complete"!==P.readyState||(r(),E.ready())}function c(e,t,n){if(void 0===n&&1===e.nodeType){var r="data-"+t.replace(B,"-$1").toLowerCase();if("string"==typeof(n=e.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:_.test(n)?E.parseJSON(n):n)}catch(e){}E.data(e,t,n)}else n=void 0}return n}function u(e){var t;for(t in e)if(("data"!==t||!E.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function o(e,t,n,r){if(E.acceptData(e)){var o,a,i=E.expando,s=e.nodeType,c=s?E.cache:e,u=s?e[i]:e[i]&&i;if(u&&c[u]&&(r||c[u].data)||void 0!==n||"string"!=typeof t)return c[u=u||(s?e[i]=h.pop()||E.guid++:i)]||(c[u]=s?{}:{toJSON:E.noop}),"object"!=typeof t&&"function"!=typeof t||(r?c[u]=E.extend(c[u],t):c[u].data=E.extend(c[u].data,t)),a=c[u],r||(a.data||(a.data={}),a=a.data),void 0!==n&&(a[E.camelCase(t)]=n),"string"==typeof t?null==(o=a[t])&&(o=a[E.camelCase(t)]):o=a,o}}function n(e,t,n){if(E.acceptData(e)){var r,o,a=e.nodeType,i=a?E.cache:e,s=a?e[E.expando]:E.expando;if(i[s]){if(t&&(r=n?i[s]:i[s].data)){o=(t=E.isArray(t)?t.concat(E.map(t,E.camelCase)):t in r?[t]:(t=E.camelCase(t))in r?[t]:t.split(" ")).length;for(;o--;)delete r[t[o]];if(n?!u(r):!E.isEmptyObject(r))return}(n||(delete i[s].data,u(i[s])))&&(a?E.cleanData([e],!0):x.deleteExpando||i!=i.window?delete i[s]:i[s]=null)}}}function a(){return!0}function l(){return!1}function e(a){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,o=e.toLowerCase().match(U)||[];if(E.isFunction(t))for(;n=o[r++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(a[n]=a[n]||[]).unshift(t)):(a[n]=a[n]||[]).push(t)}}function T(t,o,a,i){function s(e){var r;return c[e]=!0,E.each(t[e]||[],function(e,t){var n=t(o,a,i);return"string"!=typeof n||u||c[n]?u?!(r=n):void 0:(o.dataTypes.unshift(n),s(n),!1)}),r}var c={},u=t===ne;return s(o.dataTypes[0])||!c["*"]&&s("*")}function i(e,t){var n,r,o=E.ajaxSettings.flatOptions||{};for(r in t)void 0!==t[r]&&((o[r]?e:n=n||{})[r]=t[r]);return n&&E.extend(!0,e,n),e}function p(n,e,r,o){var t;if(E.isArray(e))E.each(e,function(e,t){r||ae.test(n)?o(n,t):p(n+"["+("object"==typeof t?e:"")+"]",t,r,o)});else if(r||"object"!==E.type(e))o(n,e);else for(t in e)p(n+"["+t+"]",e[t],r,o)}function f(){try{return new window.XMLHttpRequest}catch(e){}}function d(e,t){return t.toUpperCase()}var h=[],g=h.slice,m=h.concat,v=h.push,y=h.indexOf,b={},w=b.toString,S=b.hasOwnProperty,x={},C="1.11.1 -css,-css/addGetHookIf,-css/curCSS,-css/defaultDisplay,-css/hiddenVisibleSelectors,-css/support,-css/swap,-css/var/cssExpand,-css/var/isHidden,-css/var/rmargin,-css/var/rnumnonpx,-effects,-effects/Tween,-effects/animatedSelector,-effects/support,-dimensions,-offset,-deprecated,-event-alias,-wrap",E=function(e,t){return new E.fn.init(e,t)},F=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,k=/^-ms-/,j=/-([\da-z])/gi;E.fn=E.prototype={jquery:C,constructor:E,selector:"",length:0,toArray:function(){return g.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:g.call(this)},pushStack:function(e){var t=E.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return E.each(this,e,t)},map:function(n){return this.pushStack(E.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(g.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:v,sort:h.sort,splice:h.splice},E.extend=E.fn.extend=function(){var e,t,n,r,o,a,i=arguments[0]||{},s=1,c=arguments.length,u=!1;for("boolean"==typeof i&&(u=i,i=arguments[s]||{},s++),"object"==typeof i||E.isFunction(i)||(i={}),s===c&&(i=this,s--);s<c;s++)if(null!=(o=arguments[s]))for(r in o)e=i[r],i!==(n=o[r])&&(u&&n&&(E.isPlainObject(n)||(t=E.isArray(n)))?(a=t?(t=!1,e&&E.isArray(e)?e:[]):e&&E.isPlainObject(e)?e:{},i[r]=E.extend(u,a,n)):void 0!==n&&(i[r]=n));return i},E.extend({expando:"jQuery"+(C+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===E.type(e)},isArray:Array.isArray||function(e){return"array"===E.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!E.isArray(e)&&0<=e-parseFloat(e)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==E.type(e)||e.nodeType||E.isWindow(e))return!1;try{if(e.constructor&&!S.call(e,"constructor")&&!S.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(x.ownLast)for(t in e)return S.call(e,t);for(t in e);return void 0===t||S.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?b[w.call(e)]||"object":typeof e},globalEval:function(e){e&&E.trim(e)&&(window.execScript||function(e){window.eval.call(window,e)})(e)},camelCase:function(e){return e.replace(k,"ms-").replace(j,d)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r=0,o=e.length,a=s(e);if(n){if(a)for(;r<o&&!1!==t.apply(e[r],n);r++);else for(r in e)if(!1===t.apply(e[r],n))break}else if(a)for(;r<o&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(F,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(s(Object(e))?E.merge(n,"string"==typeof e?[e]:e):v.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(y)return y.call(t,e,n);for(r=t.length,n=n?n<0?Math.max(0,r+n):n:0;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){for(var n=+t.length,r=0,o=e.length;r<n;)e[o++]=t[r++];if(n!=n)for(;void 0!==t[r];)e[o++]=t[r++];return e.length=o,e},grep:function(e,t,n){for(var r=[],o=0,a=e.length,i=!n;o<a;o++)!t(e[o],o)!=i&&r.push(e[o]);return r},map:function(e,t,n){var r,o=0,a=e.length,i=[];if(s(e))for(;o<a;o++)null!=(r=t(e[o],o,n))&&i.push(r);else for(o in e)null!=(r=t(e[o],o,n))&&i.push(r);return m.apply([],i)},guid:1,proxy:function(e,t){var n,r,o;if("string"==typeof t&&(o=e[t],t=e,e=o),E.isFunction(e))return n=g.call(arguments,2),(r=function(){return e.apply(t||this,n.concat(g.call(arguments)))}).guid=e.guid=e.guid||E.guid++,r},now:function(){return+new Date},support:x}),E.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){b["[object "+t+"]"]=t.toLowerCase()});var A,P=window.document,D=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(E.fn.init=function(e,t){var n,r;if(!e)return this;if("string"!=typeof e)return e.nodeType?(this.context=this[0]=e,this.length=1,this):E.isFunction(e)?void 0!==A.ready?A.ready(e):e(E):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),E.makeArray(e,this));if(!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:D.exec(e))||!n[1]&&t)return!t||t.jquery?(t||A).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof E?t[0]:t,E.merge(this,E.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:P,!0)),rsingleTag.test(n[1])&&E.isPlainObject(t))for(n in t)E.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}if((r=P.getElementById(n[2]))&&r.parentNode){if(r.id!==n[2])return A.find(e);this.length=1,this[0]=r}return this.context=P,this.selector=e,this}).prototype=E.fn,A=E(P);var R,U=/\S+/g,I={};E.Callbacks=function(o){o="string"==typeof o?I[o]||function(e){var n=I[e]={};return E.each(e.match(U)||[],function(e,t){n[t]=!0}),n}(o):E.extend({},o);var r,t,n,a,i,s,c=[],u=!o.once&&[],l=function(e){for(t=o.memory&&e,n=!0,i=s||0,s=0,a=c.length,r=!0;c&&i<a;i++)if(!1===c[i].apply(e[0],e[1])&&o.stopOnFalse){t=!1;break}r=!1,c&&(u?u.length&&l(u.shift()):t?c=[]:p.disable())},p={add:function(){if(c){var e=c.length;!function r(e){E.each(e,function(e,t){var n=E.type(t);"function"===n?o.unique&&p.has(t)||c.push(t):t&&t.length&&"string"!==n&&r(t)})}(arguments),r?a=c.length:t&&(s=e,l(t))}return this},remove:function(){return c&&E.each(arguments,function(e,t){for(var n;-1<(n=E.inArray(t,c,n));)c.splice(n,1),r&&(n<=a&&a--,n<=i&&i--)}),this},has:function(e){return e?-1<E.inArray(e,c):!(!c||!c.length)},empty:function(){return c=[],a=0,this},disable:function(){return c=u=t=void 0,this},disabled:function(){return!c},lock:function(){return u=void 0,t||p.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!c||n&&!u||(t=[e,(t=t||[]).slice?t.slice():t],r?u.push(t):l(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!n}};return p},E.extend({Deferred:function(e){var a=[["resolve","done",E.Callbacks("once memory"),"resolved"],["reject","fail",E.Callbacks("once memory"),"rejected"],["notify","progress",E.Callbacks("memory")]],o="pending",i={state:function(){return o},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var o=arguments;return E.Deferred(function(r){E.each(a,function(e,t){var n=E.isFunction(o[e])&&o[e];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&E.isFunction(e.promise)?e.promise().done(r.resolve).fail(r.reject).progress(r.notify):r[t[0]+"With"](this===i?r.promise():this,n?[e]:arguments)})}),o=null}).promise()},promise:function(e){return null!=e?E.extend(e,i):i}},s={};return i.pipe=i.then,E.each(a,function(e,t){var n=t[2],r=t[3];i[t[1]]=n.add,r&&n.add(function(){o=r},a[1^e][2].disable,a[2][2].lock),s[t[0]]=function(){return s[t[0]+"With"](this===s?i:this,arguments),this},s[t[0]+"With"]=n.fireWith}),i.promise(s),e&&e.call(s,s),s},when:function(e){function t(t,n,r){return function(e){n[t]=this,r[t]=1<arguments.length?g.call(arguments):e,r===o?u.notifyWith(n,r):--c||u.resolveWith(n,r)}}var o,n,r,a=0,i=g.call(arguments),s=i.length,c=1!==s||e&&E.isFunction(e.promise)?s:0,u=1===c?e:E.Deferred();if(1<s)for(o=new Array(s),n=new Array(s),r=new Array(s);a<s;a++)i[a]&&E.isFunction(i[a].promise)?i[a].promise().done(t(a,r,i)).fail(u.reject).progress(t(a,n,o)):--c;return c||u.resolveWith(r,i),u.promise()}}),E.fn.ready=function(e){return E.ready.promise().done(e),this},E.extend({isReady:!1,readyWait:1,holdReady:function(e){e?E.readyWait++:E.ready(!0)},ready:function(e){if(!0===e?!--E.readyWait:!E.isReady){if(!P.body)return setTimeout(E.ready);(E.isReady=!0)!==e&&0<--E.readyWait||(R.resolveWith(P,[E]),E.fn.triggerHandler&&(E(P).triggerHandler("ready"),E(P).off("ready")))}}}),E.ready.promise=function(e){if(!R)if(R=E.Deferred(),"complete"===P.readyState)setTimeout(E.ready);else if(P.addEventListener)P.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1);else{P.attachEvent("onreadystatechange",t),window.attachEvent("onload",t);var n=!1;try{n=null==window.frameElement&&P.documentElement}catch(e){}n&&n.doScroll&&!function t(){if(!E.isReady){try{n.doScroll("left")}catch(e){return setTimeout(t,50)}r(),E.ready()}}()}return R.promise(e)};var O,L="undefined";for(O in E(x))break;x.ownLast="0"!==O,x.inlineBlockNeedsLayout=!1,E(function(){var e,t,n,r;(n=P.getElementsByTagName("body")[0])&&n.style&&(t=P.createElement("div"),(r=P.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(r).appendChild(t),typeof t.style.zoom!=L&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",x.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(n.style.zoom=1)),n.removeChild(r))}),function(){var e=P.createElement("div");if(null==x.deleteExpando){x.deleteExpando=!0;try{delete e.test}catch(e){x.deleteExpando=!1}}e=null}(),E.acceptData=function(e){var t=E.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return(1===n||9===n)&&(!t||!0!==t&&e.getAttribute("classid")===t)};var _=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,B=/([A-Z])/g;E.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?E.cache[e[E.expando]]:e[E.expando])&&!u(e)},data:function(e,t,n){return o(e,t,n)},removeData:function(e,t){return n(e,t)},_data:function(e,t,n){return o(e,t,n,!0)},_removeData:function(e,t){return n(e,t,!0)}}),E.fn.extend({data:function(e,t){var n,r,o,a=this[0],i=a&&a.attributes;if(void 0!==e)return"object"==typeof e?this.each(function(){E.data(this,e)}):1<arguments.length?this.each(function(){E.data(this,e,t)}):a?c(a,e,E.data(a,e)):void 0;if(this.length&&(o=E.data(a),1===a.nodeType&&!E._data(a,"parsedAttrs"))){for(n=i.length;n--;)i[n]&&(0===(r=i[n].name).indexOf("data-")&&c(a,r=E.camelCase(r.slice(5)),o[r]));E._data(a,"parsedAttrs",!0)}return o},removeData:function(e){return this.each(function(){E.removeData(this,e)})}}),E.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=E._data(e,t),n&&(!r||E.isArray(n)?r=E._data(e,t,E.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=E.queue(e,t),r=n.length,o=n.shift(),a=E._queueHooks(e,t);"inprogress"===o&&(o=n.shift(),r--),o&&("fx"===t&&n.unshift("inprogress"),delete a.stop,o.call(e,function(){E.dequeue(e,t)},a)),!r&&a&&a.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return E._data(e,n)||E._data(e,n,{empty:E.Callbacks("once memory").add(function(){E._removeData(e,t+"queue"),E._removeData(e,n)})})}}),E.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?E.queue(this[0],t):void 0===n?this:this.each(function(){var e=E.queue(this,t,n);E._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&E.dequeue(this,t)})},dequeue:function(e){return this.each(function(){E.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function n(){--o||a.resolveWith(i,[i])}var r,o=1,a=E.Deferred(),i=this,s=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(r=E._data(i[s],e+"queueHooks"))&&r.empty&&(o++,r.empty.add(n));return n(),a.promise(t)}}),E.event={global:{},add:function(e,t,n,r,o){var a,i,s,c,u,l,p,f,d,h,g,m=E._data(e);if(m){for(n.handler&&(n=(c=n).handler,o=c.selector),n.guid||(n.guid=E.guid++),(i=m.events)||(i=m.events={}),(l=m.handle)||((l=m.handle=function(e){return typeof E==L||e&&E.event.triggered===e.type?void 0:E.event.dispatch.apply(l.elem,arguments)}).elem=e),s=(t=(t||"").match(U)||[""]).length;s--;)d=g=(a=z.exec(t[s])||[])[1],h=(a[2]||"").split(".").sort(),d&&(u=E.event.special[d]||{},d=(o?u.delegateType:u.bindType)||d,u=E.event.special[d]||{},p=E.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:o,needsContext:o&&E.expr.match.needsContext.test(o),namespace:h.join(".")},c),(f=i[d])||((f=i[d]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,r,h,l)||(e.addEventListener?e.addEventListener(d,l,!1):e.attachEvent&&e.attachEvent("on"+d,l))),u.add&&(u.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),o?f.splice(f.delegateCount++,0,p):f.push(p),E.event.global[d]=!0);e=null}},remove:function(e,t,n,r,o){var a,i,s,c,u,l,p,f,d,h,g,m=E.hasData(e)&&E._data(e);if(m&&(l=m.events)){for(u=(t=(t||"").match(U)||[""]).length;u--;)if(d=g=(s=z.exec(t[u])||[])[1],h=(s[2]||"").split(".").sort(),d){for(p=E.event.special[d]||{},f=l[d=(r?p.delegateType:p.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),c=a=f.length;a--;)i=f[a],!o&&g!==i.origType||n&&n.guid!==i.guid||s&&!s.test(i.namespace)||r&&r!==i.selector&&("**"!==r||!i.selector)||(f.splice(a,1),i.selector&&f.delegateCount--,p.remove&&p.remove.call(e,i));c&&!f.length&&(p.teardown&&!1!==p.teardown.call(e,h,m.handle)||E.removeEvent(e,d,m.handle),delete l[d])}else for(d in l)E.event.remove(e,d+t[u],n,r,!0);E.isEmptyObject(l)&&(delete m.handle,E._removeData(e,"events"))}},trigger:function(e,t,n,r){var o,a,i,s,c,u,l,p=[n||P],f=S.call(e,"type")?e.type:e,d=S.call(e,"namespace")?e.namespace.split("."):[];if(i=u=n=n||P,3!==n.nodeType&&8!==n.nodeType&&!G.test(f+E.event.triggered)&&(0<=f.indexOf(".")&&(f=(d=f.split(".")).shift(),d.sort()),a=f.indexOf(":")<0&&"on"+f,(e=e[E.expando]?e:new E.Event(f,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=d.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:E.makeArray(t,[e]),c=E.event.special[f]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!E.isWindow(n)){for(s=c.delegateType||f,G.test(s+f)||(i=i.parentNode);i;i=i.parentNode)p.push(i),u=i;u===(n.ownerDocument||P)&&p.push(u.defaultView||u.parentWindow||window)}for(l=0;(i=p[l++])&&!e.isPropagationStopped();)e.type=1<l?s:c.bindType||f,(o=(E._data(i,"events")||{})[e.type]&&E._data(i,"handle"))&&o.apply(i,t),(o=a&&i[a])&&o.apply&&E.acceptData(i)&&(e.result=o.apply(i,t),!1===e.result&&e.preventDefault());if(e.type=f,!r&&!e.isDefaultPrevented()&&(!c._default||!1===c._default.apply(p.pop(),t))&&E.acceptData(n)&&a&&n[f]&&!E.isWindow(n)){(u=n[a])&&(n[a]=null),E.event.triggered=f;try{n[f]()}catch(e){}E.event.triggered=void 0,u&&(n[a]=u)}return e.result}},dispatch:function(e){e=E.event.fix(e);var t,n,r,o,a,i=[],s=g.call(arguments),c=(E._data(this,"events")||{})[e.type]||[],u=E.event.special[e.type]||{};if((s[0]=e).delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,e)){for(i=E.event.handlers.call(this,e,c),t=0;(o=i[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,a=0;(r=o.handlers[a++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(r.namespace)||(e.handleObj=r,e.data=r.data,void 0!==(n=((E.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,s))&&!1===(e.result=n)&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,o,a,i=[],s=t.delegateCount,c=e.target;if(s&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(!0!==c.disabled||"click"!==e.type)){for(o=[],a=0;a<s;a++)void 0===o[n=(r=t[a]).selector+" "]&&(o[n]=r.needsContext?0<=E(n,this).index(c):E.find(n,this,null,[c]).length),o[n]&&o.push(r);o.length&&i.push({elem:c,handlers:o})}return s<t.length&&i.push({elem:this,handlers:t.slice(s)}),i},fix:function(e){if(e[E.expando])return e;var t,n,r,o=e.type,a=e,i=this.fixHooks[o];for(i||(this.fixHooks[o]=i=H.test(o)?this.mouseHooks:M.test(o)?this.keyHooks:{}),r=i.props?this.props.concat(i.props):this.props,e=new E.Event(a),t=r.length;t--;)e[n=r[t]]=a[n];return e.target||(e.target=a.srcElement||P),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,i.filter?i.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,o,a=t.button,i=t.fromElement;return null==e.pageX&&null!=t.clientX&&(o=(r=e.target.ownerDocument||P).documentElement,n=r.body,e.pageX=t.clientX+(o&&o.scrollLeft||n&&n.scrollLeft||0)-(o&&o.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(o&&o.scrollTop||n&&n.scrollTop||0)-(o&&o.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&i&&(e.relatedTarget=i===e.target?t.toElement:i),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(E.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return E.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var o=E.extend(new E.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?E.event.trigger(o,null,t):E.event.dispatch.call(t,o),o.isDefaultPrevented()&&n.preventDefault()}},E.removeEvent=P.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]==L&&(e[r]=null),e.detachEvent(r,n))},E.Event=function(e,t){return this instanceof E.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?a:l):this.type=e,t&&E.extend(this,t),this.timeStamp=e&&e.timeStamp||E.now(),void(this[E.expando]=!0)):new E.Event(e,t)};var N=/^(?:input|select|textarea)$/i,M=/^key/,H=/^(?:mouse|pointer|contextmenu)|click/,G=/^(?:focusinfocus|focusoutblur)$/,z=/^([^.]*)(?:\.(.+)|)$/;E.Event.prototype={isDefaultPrevented:l,isPropagationStopped:l,isImmediatePropagationStopped:l,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=a,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=a,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=a,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},x.submitBubbles||(E.event.special.submit={setup:function(){return!E.nodeName(this,"form")&&void E.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=E.nodeName(t,"input")||E.nodeName(t,"button")?t.form:void 0;n&&!E._data(n,"submitBubbles")&&(E.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),E._data(n,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&E.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return!E.nodeName(this,"form")&&void E.event.remove(this,"._submit")}}),x.changeBubbles||(E.event.special.change={setup:function(){return N.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(E.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),E.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),E.event.simulate("change",this,e,!0)})),!1):void E.event.add(this,"beforeactivate._change",function(e){var t=e.target;N.test(t.nodeName)&&!E._data(t,"changeBubbles")&&(E.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||E.event.simulate("change",this.parentNode,e,!0)}),E._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return E.event.remove(this,"._change"),!N.test(this.nodeName)}}),x.focusinBubbles||E.each({focus:"focusin",blur:"focusout"},function(n,r){function o(e){E.event.simulate(r,e.target,E.event.fix(e),!0)}E.event.special[r]={setup:function(){var e=this.ownerDocument||this,t=E._data(e,r);t||e.addEventListener(n,o,!0),E._data(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=E._data(e,r)-1;t?E._data(e,r,t):(e.removeEventListener(n,o,!0),E._removeData(e,r))}}}),E.fn.extend({on:function(e,t,n,r,o){var a,i;if("object"==typeof e){for(a in"string"!=typeof t&&(n=n||t,t=void 0),e)this.on(a,t,n,e[a],o);return this}if(null==n&&null==r?(r=t,n=t=void 0):null==r&&("string"==typeof t?(r=n,n=void 0):(r=n,n=t,t=void 0)),!1===r)r=l;else if(!r)return this;return 1===o&&(i=r,(r=function(e){return E().off(e),i.apply(this,arguments)}).guid=i.guid||(i.guid=E.guid++)),this.each(function(){E.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,E(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=l),this.each(function(){E.event.remove(this,e,n,t)});for(o in e)this.off(o,t,e[o]);return this},trigger:function(e,t){return this.each(function(){E.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return E.event.trigger(e,t,n,!0)}}),E.fn.delay=function(r,e){return r=E.fx&&E.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=setTimeout(e,r);t.stop=function(){clearTimeout(n)}})};var q=E.now(),X=/\?/,W=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;E.parseJSON=function(e){if(window.JSON&&window.JSON.parse)return window.JSON.parse(e+"");var o,a=null,t=E.trim(e+"");return t&&!E.trim(t.replace(W,function(e,t,n,r){return o&&t&&(a=0),0===a?e:(o=n||t,a+=!r-!n,"")}))?Function("return "+t)():E.error("Invalid JSON: "+e)},E.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{window.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(e){t=void 0}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||E.error("Invalid XML: "+e),t};var Y,J,V=/#.*$/,$=/([?&])_=[^&]*/,K=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Q=/^(?:GET|HEAD)$/,Z=/^\/\//,ee=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,te={},ne={},re="*/".concat("*");try{J=location.href}catch(e){(J=P.createElement("a")).href="",J=J.href}Y=ee.exec(J.toLowerCase())||[],E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:J,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Y[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":re,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":E.parseJSON,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?i(i(e,E.ajaxSettings),t):i(E.ajaxSettings,e)},ajaxPrefilter:e(te),ajaxTransport:e(ne),ajax:function(e,t){function n(e,t,n,r){var o,a,i,s,c,u=t;2!==S&&(S=2,f&&clearTimeout(f),h=void 0,p=r||"",x.readyState=0<e?4:0,o=200<=e&&e<300||304===e,n&&(s=function(e,t,n){for(var r,o,a,i,s=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===o&&(o=e.mimeType||t.getResponseHeader("Content-Type"));if(o)for(i in s)if(s[i]&&s[i].test(o)){c.unshift(i);break}if(c[0]in n)a=c[0];else{for(i in n){if(!c[0]||e.converters[i+" "+c[0]]){a=i;break}r=r||i}a=a||r}if(a)return a!==c[0]&&c.unshift(a),n[a]}(g,x,n)),s=function(e,t,n,r){var o,a,i,s,c,u={},l=e.dataTypes.slice();if(l[1])for(i in e.converters)u[i.toLowerCase()]=e.converters[i];for(a=l.shift();a;)if(e.responseFields[a]&&(n[e.responseFields[a]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=a,a=l.shift())if("*"===a)a=c;else if("*"!==c&&c!==a){if(!(i=u[c+" "+a]||u["* "+a]))for(o in u)if((s=o.split(" "))[1]===a&&(i=u[c+" "+s[0]]||u["* "+s[0]])){!0===i?i=u[o]:!0!==u[o]&&(a=s[0],l.unshift(s[1]));break}if(!0!==i)if(i&&e.throws)t=i(t);else try{t=i(t)}catch(e){return{state:"parsererror",error:i?e:"No conversion from "+c+" to "+a}}}return{state:"success",data:t}}(g,s,x,o),o?(g.ifModified&&((c=x.getResponseHeader("Last-Modified"))&&(E.lastModified[l]=c),(c=x.getResponseHeader("etag"))&&(E.etag[l]=c)),204===e||"HEAD"===g.type?u="nocontent":304===e?u="notmodified":(u=s.state,a=s.data,o=!(i=s.error))):(i=u,!e&&u||(u="error",e<0&&(e=0))),x.status=e,x.statusText=(t||u)+"",o?y.resolveWith(m,[a,u,x]):y.rejectWith(m,[x,u,i]),x.statusCode(w),w=void 0,d&&v.trigger(o?"ajaxSuccess":"ajaxError",[x,g,o?a:i]),b.fireWith(m,[x,u]),d&&(v.trigger("ajaxComplete",[x,g]),--E.active||E.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var r,o,l,p,f,d,h,a,g=E.ajaxSetup({},t),m=g.context||g,v=g.context&&(m.nodeType||m.jquery)?E(m):E.event,y=E.Deferred(),b=E.Callbacks("once memory"),w=g.statusCode||{},i={},s={},S=0,c="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===S){if(!a)for(a={};t=K.exec(p);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===S?p:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return S||(e=s[n]=s[n]||e,i[e]=t),this},overrideMimeType:function(e){return S||(g.mimeType=e),this},statusCode:function(e){var t;if(e)if(S<2)for(t in e)w[t]=[w[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||c;return h&&h.abort(t),n(0,t),this}};if(y.promise(x).complete=b.add,x.success=x.done,x.error=x.fail,g.url=((e||g.url||J)+"").replace(V,"").replace(Z,Y[1]+"//"),g.type=t.method||t.type||g.method||g.type,g.dataTypes=E.trim(g.dataType||"*").toLowerCase().match(U)||[""],null==g.crossDomain&&(r=ee.exec(g.url.toLowerCase()),g.crossDomain=!(!r||r[1]===Y[1]&&r[2]===Y[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(Y[3]||("http:"===Y[1]?"80":"443")))),g.data&&g.processData&&"string"!=typeof g.data&&(g.data=E.param(g.data,g.traditional)),T(te,g,t,x),2===S)return x;for(o in(d=g.global)&&0==E.active++&&E.event.trigger("ajaxStart"),g.type=g.type.toUpperCase(),g.hasContent=!Q.test(g.type),l=g.url,g.hasContent||(g.data&&(l=g.url+=(X.test(l)?"&":"?")+g.data,delete g.data),!1===g.cache&&(g.url=$.test(l)?l.replace($,"$1_="+q++):l+(X.test(l)?"&":"?")+"_="+q++)),g.ifModified&&(E.lastModified[l]&&x.setRequestHeader("If-Modified-Since",E.lastModified[l]),E.etag[l]&&x.setRequestHeader("If-None-Match",E.etag[l])),(g.data&&g.hasContent&&!1!==g.contentType||t.contentType)&&x.setRequestHeader("Content-Type",g.contentType),x.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+("*"!==g.dataTypes[0]?", "+re+"; q=0.01":""):g.accepts["*"]),g.headers)x.setRequestHeader(o,g.headers[o]);if(g.beforeSend&&(!1===g.beforeSend.call(m,x,g)||2===S))return x.abort();for(o in c="abort",{success:1,error:1,complete:1})x[o](g[o]);if(h=T(ne,g,t,x)){x.readyState=1,d&&v.trigger("ajaxSend",[x,g]),g.async&&0<g.timeout&&(f=setTimeout(function(){x.abort("timeout")},g.timeout));try{S=1,h.send(i,n)}catch(e){if(!(S<2))throw e;n(-1,e)}}else n(-1,"No Transport");return x},getJSON:function(e,t,n){return E.get(e,t,n,"json")},getScript:function(e,t){return E.get(e,void 0,t,"script")}}),E.each(["get","post"],function(e,o){E[o]=function(e,t,n,r){return E.isFunction(t)&&(r=r||n,n=t,t=void 0),E.ajax({url:e,type:o,dataType:r,data:t,success:n})}}),E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){E.fn[t]=function(e){return this.on(t,e)}}),E._evalUrl=function(e){return E.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})};var oe=/%20/g,ae=/\[\]$/,ie=/\r?\n/g,se=/^(?:submit|button|image|reset|file)$/i,ce=/^(?:input|select|textarea|keygen)/i;E.param=function(e,t){function n(e,t){t=E.isFunction(t)?t():null==t?"":t,o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)}var r,o=[];if(void 0===t&&(t=E.ajaxSettings&&E.ajaxSettings.traditional),E.isArray(e)||e.jquery&&!E.isPlainObject(e))E.each(e,function(){n(this.name,this.value)});else for(r in e)p(r,e[r],t,n);return o.join("&").replace(oe,"+")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=E.prop(this,"elements");return e?E.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!E(this).is(":disabled")&&ce.test(this.nodeName)&&!se.test(e)&&(this.checked||!rcheckableType.test(e))}).map(function(e,t){var n=E(this).val();return null==n?null:E.isArray(n)?E.map(n,function(e){return{name:t.name,value:e.replace(ie,"\r\n")}}):{name:t.name,value:n.replace(ie,"\r\n")}}).get()}}),E.ajaxSettings.xhr=void 0!==window.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&f()||function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:f;var ue=0,le={},pe=E.ajaxSettings.xhr();window.ActiveXObject&&E(window).on("unload",function(){for(var e in le)le[e](void 0,!0)}),x.cors=!!pe&&"withCredentials"in pe,(pe=x.ajax=!!pe)&&E.ajaxTransport(function(c){var u;if(!c.crossDomain||x.cors)return{send:function(e,a){var t,i=c.xhr(),s=++ue;if(i.open(c.type,c.url,c.async,c.username,c.password),c.xhrFields)for(t in c.xhrFields)i[t]=c.xhrFields[t];for(t in c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)void 0!==e[t]&&i.setRequestHeader(t,e[t]+"");i.send(c.hasContent&&c.data||null),u=function(e,t){var n,r,o;if(u&&(t||4===i.readyState))if(delete le[s],u=void 0,i.onreadystatechange=E.noop,t)4!==i.readyState&&i.abort();else{o={},n=i.status,"string"==typeof i.responseText&&(o.text=i.responseText);try{r=i.statusText}catch(e){r=""}n||!c.isLocal||c.crossDomain?1223===n&&(n=204):n=o.text?200:404}o&&a(n,r,o,i.getAllResponseHeaders())},c.async?4===i.readyState?setTimeout(u):i.onreadystatechange=le[s]=u:u()},abort:function(){u&&u(void 0,!0)}}}),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return E.globalEval(e),e}}}),E.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),E.ajaxTransport("script",function(t){if(t.crossDomain){var r,o=P.head||E("head")[0]||P.documentElement;return{send:function(e,n){(r=P.createElement("script")).async=!0,t.scriptCharset&&(r.charset=t.scriptCharset),r.src=t.url,r.onload=r.onreadystatechange=function(e,t){!t&&r.readyState&&!/loaded|complete/.test(r.readyState)||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),r=null,t||n(200,"success"))},o.insertBefore(r,o.firstChild)},abort:function(){r&&r.onload(void 0,!0)}}}});var fe=[],de=/(=)\?(?=&|$)|\?\?/;return E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=fe.pop()||E.expando+"_"+q++;return this[e]=!0,e}}),E.ajaxPrefilter("json jsonp",function(e,t,n){var r,o,a,i=!1!==e.jsonp&&(de.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&de.test(e.data)&&"data");if(i||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=E.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,i?e[i]=e[i].replace(de,"$1"+r):!1!==e.jsonp&&(e.url+=(X.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return a||E.error(r+" was not called"),a[0]},e.dataTypes[0]="json",o=window[r],window[r]=function(){a=arguments},n.always(function(){window[r]=o,e[r]&&(e.jsonpCallback=t.jsonpCallback,fe.push(r)),a&&E.isFunction(o)&&o(a[0]),a=o=void 0}),"script"}),E.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||P;var r=rsingleTag.exec(e),o=!n&&[];return r?[t.createElement(r[1])]:(r=E.buildFragment([e],t,o),o&&o.length&&E(o).remove(),E.merge([],r.childNodes))},E}(),o=function(i,e,t){var r,s,a,c,u,l,p,f,d=0,h=[],g=0,m=!1,o=[],v=[],y=!1;if(r=(t=t||{}).encoding||"UTF8",(f=t.numRounds||1)!==parseInt(f,10)||f<1)throw Error("numRounds must a integer >= 1");if("SHA-1"!==i)throw Error("Chosen SHA variant is not supported");u=F,l=n,c=160,p=function(e){return e.slice()},a=C(e,r),s=E(i),this.setHMACKey=function(e,t,n){if(!0===m)throw Error("HMAC key already set");if(!0===y)throw Error("Cannot set HMAC key after calling update");if(e=(t=C(t,r=(n||{}).encoding||"UTF8")(e)).binLen,t=t.value,n=15,64<e/8){for(t=l(t,e,0,E(i),c);t.length<=n;)t.push(0);t[n]&=4294967040}else if(e/8<64){for(;t.length<=n;)t.push(0);t[n]&=4294967040}for(e=0;e<=n;e+=1)o[e]=909522486^t[e],v[e]=1549556828^t[e];s=u(o,s),d=512,m=!0},this.update=function(e){var t,n,r,o=0;for(e=(t=a(e,h,g)).binLen,n=t.value,t=e>>>5,r=0;r<t;r+=16)o+512<=e&&(s=u(n.slice(r,r+16),s),o+=512);return d+=o,h=n.slice(o>>>5),g=e%512,y=!0,function(e){for(var t="",n=0;n<5;n++)for(var r=0;r<4;r++){var o=e[n]>>>8*r;o&=255;var a=Number(o).toString(16);t+=a=a.length<2?"0"+a:a}return t}(s)},this.getHash=function(e,t){var n,r,o,a;if(!0===m)throw Error("Cannot call getHash after setting HMAC key");switch(o=T(t),e){case"HEX":n=function(e){return b(e,c,o)};break;case"B64":n=function(e){return w(e,c,o)};break;case"BYTES":n=function(e){return S(e,c)};break;case"ARRAYBUFFER":try{r=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}n=function(e){return x(e,c)};break;default:throw Error("format must be HEX, B64, BYTES, or ARRAYBUFFER")}for(a=l(h.slice(),g,d,p(s),c),r=1;r<f;r+=1)a=l(a,c,0,E(i),c);return n(a)},this.getHMAC=function(e,t){var n,r,o,a;if(!1===m)throw Error("Cannot call getHMAC without first setting HMAC key");switch(o=T(t),e){case"HEX":n=function(e){return b(e,c,o)};break;case"B64":n=function(e){return w(e,c,o)};break;case"BYTES":n=function(e){return S(e,c)};break;case"ARRAYBUFFER":try{n=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}n=function(e){return x(e,c)};break;default:throw Error("outputFormat must be HEX, B64, BYTES, or ARRAYBUFFER")}return r=l(h.slice(),g,d,p(s),c),a=u(v,E(i)),n(a=l(r,c,512,a,c))}},e.exports=function(){function e(e){this.appid=e.appid,this.bucket=e.bucket,this.region=e.region,this.sha1CacheExpired=259200,this.uploadMaxThread=5,this.uploadMaxRetryTimes=3,this._uploadingThreadCount=0,this.tasks=[],e.getAppSign&&(this.getAppSign=t(e.getAppSign,this)),e.getAppSignOnce&&(this.getAppSignOnce=t(e.getAppSignOnce,this))}function t(e,n){return function(t){e.call(n,function(e){decodeURIComponent(e)===e&&(e=encodeURIComponent(e)),t(e)})}}function d(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function h(e,t){return e?(e=e.replace(/(^\/*)/g,""),e="folder"==t?encodeURIComponent(e+"/").replace(/%2F/g,"/"):encodeURIComponent(e).replace(/%2F/g,"/"),this&&(this.path="/"+this.appid+"/"+this.bucket+"/"+e),e):""}function g(a){var i,s=k.Deferred(),c=new o("SHA-1","BYTES"),u=0,l=a.sliceSize,p=new FileReader,f=[],d=a.file,h=d.size;return a.session&&(i=r(a.session)),p.onload=function(e){if("cancel"!==a.globalTask.state&&d&&!(d.length<1)){var t=c.update(this.content||this.result),n=h<u+l?h-u:l,r=u+n<h,o=r?t:c.getHash("HEX");if(!function(e){f.push(e);var t=e.offset+"-"+e.datalen;return!i||!i[t]||e.datasha===i[t]}({offset:u,datalen:n,datasha:o}))return void s.reject("sha1 not match");u+=n,a.onprogress(0,u/h),r?y.call(p,d.slice(u,Math.min(u+l,h))):s.resolve(f)}},y.call(p,d.slice(u,u+l)),p.onerror=function(){s.reject()},s.promise()}function m(a){var n,r=this,i=a.file,o=k.Deferred(),s={opt:a,uploadingAjax:[],uploadingCount:0,currentIndex:0,chunkCount:Math.ceil(i.size/a.slice_size),chunks:[],loadedSize:0,uploadError:!1,onTaskProgress:function(e){var t=function(){n=0,a.onprogress&&a.onprogress(s.loadedSize/i.size,1)};if(e)clearTimeout(n),t();else{if(n)return;n=setTimeout(t,100)}}};!function(){var e,t={};if(a.listparts)for(e=0;e<a.listparts.length;e++)t[a.listparts[e].offset]=a.listparts[e];for(e=0;e<s.chunkCount;e++){var n=e*a.slice_size,r=Math.min(n+a.slice_size,i.size),o={start:n,end:r,size:r-n};t[n]?(s.loadedSize+=o.size,o.state="online"):o.state="waiting",s.chunks.push(o)}}();var c=function(){s.onTaskProgress(!0),o.resolve()},u=function(e,t){s.uploadError="error";for(var n=s.uploadingAjax.length-1;0<=n;n--){var r=s.uploadingAjax[n];r&&r.abort()}s.onTaskProgress(!0),o.reject(t)};a.globalTask.cancelRequests=function(){for(var e=s.uploadingAjax.length-1;0<=e;e--){var t=s.uploadingAjax[e];t&&t.abort()}};var l=function(){if("cancel"!==a.globalTask.state){for(;r._uploadingThreadCount<r.uploadMaxThread&&s.currentIndex<s.chunkCount;s.currentIndex++){var e=s.chunks[s.currentIndex];"waiting"===e.state&&function(n){n.state="uploading",s.uploadingCount++,r._uploadingThreadCount++,p.call(r,s,n,function(e,t){s.uploadingCount--,r._uploadingThreadCount--,e?(n.state="error",u(e,t)):(n.state="success",s.uploadingCount<=0&&s.currentIndex>=s.chunkCount?c():l())})}(e)}0===s.uploadingCount&&s.currentIndex===s.chunks.length&&c()}};return l(),o.promise()}function v(o){var a=this,i=k.Deferred(),s=o.file;return a.getAppSign(function(e){o.sign=e;var t=o.session,n=a.getCgiUrl(o.path,o.sign),r=new FormData;o.sha&&r.append("sha",o.sha),r.append("op","upload_slice_finish"),r.append("filesize",s.size),r.append("session",t),k.ajax({type:"POST",dataType:"JSON",url:n,data:r,success:function(e){0==(e=e||{}).code?i.resolve(e):i.reject(e)},error:function(){i.reject()},processData:!1,contentType:!1})}),i.promise()}function y(e){var t;FileReader.prototype.readAsBinaryString?t=FileReader.prototype.readAsBinaryString:FileReader.prototype.readAsArrayBuffer?t=function(e){var o="",a=this,i=new FileReader;i.onload=function(e){for(var t=new Uint8Array(i.result),n=t.byteLength,r=0;r<n;r++)o+=String.fromCharCode(t[r]);a.content=o,a.onload()},i.readAsArrayBuffer(e)}:console.error("FileReader not support readAsBinaryString"),t.call(this,e)}var b=function(){var o=function(e,t){e=e.split("."),t=t.split(".");for(var n=0;n<t.length;n++)if(e[n]!==t[n])return parseInt(e[n])>parseInt(t[n])?1:-1;return 0};return function(e){var t=(e.match(/Chrome\/([.\d]+)/)||[])[1],n=(e.match(/QBCore\/([.\d]+)/)||[])[1],r=(e.match(/QQBrowser\/([.\d]+)/)||[])[1];return t&&o(t,"53.0.2785.116")<0&&n&&o(n,"3.53.991.400")<0&&r&&o(r,"9.0.2524.400")<=0||!1}(navigator.userAgent)}(),n=1048576;e.version="1.2.0",e.prototype.cosapi_cgi_url=("https:"===location.protocol?"https:":"http:")+"//REGION.file.myqcloud.com/files/v2/",e.prototype.slice=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,e.prototype.sliceSize=3145728,e.prototype.getExpired=function(e){return(new Date).getTime()/1e3+(e||60)},e.prototype.getSliceSize=function(e){return e<=524288?524288:n},e.prototype.set=function(e){e&&(this.appid=e.appid,this.bucket=e.bucket,this.region=e.region,e.getAppSign&&(this.getAppSign=e.getAppSign),e.getAppSignOnce&&(this.getAppSignOnce=e.getAppSignOnce))},e.prototype.getCgiUrl=function(e,t){var n=this.region,r=this.bucket,o=this.cosapi_cgi_url;return(o=o.replace("REGION",n))+this.appid+"/"+r+"/"+e+"?sign="+t},e.prototype.getAppSign=function(e,t,n){var r=this.getExpired(),o=this.sign_url+"?sign_type=appSign&expired="+r+"&bucketName="+n;k.ajax({url:o,type:"GET",success:e,error:t})},e.prototype.getAppSignOnce=function(e,t,n,r){var o=this.sign_url+"?sign_type=appSign_once&path="+encodeURIComponent(n)+"&bucketName="+r;k.ajax({url:o,type:"GET",success:e,error:t})},e.prototype.updateFolder=function(e,t,n,r,o){r=h.call(this,r,"folder"),this.updateBase(e,t,n,r,o)},e.prototype.updateFile=function(e,t,n,r,o){r=h.call(this,r),this.updateBase(e,t,n,r,o)},e.prototype.updateBase=function(r,o,e,a,i,s,c){var u=this;u.getAppSignOnce(function(e){var t=u.getCgiUrl(a,e),n=new FormData;n.append("op","update"),i&&n.append("biz_attr",i),s&&n.append("authority",s),c&&(c=JSON.stringify(c),n.append("customHeaders",c)),k.ajax({type:"POST",url:t,processData:!1,contentType:!1,data:n,success:r,error:o})})},e.prototype.deleteFolder=function(e,t,n,r){r=h.call(this,r,"folder"),this.deleteBase(e,t,n,r)},e.prototype.deleteFile=function(e,t,n,r){r=h.call(this,r),this.deleteBase(e,t,n,r)},e.prototype.deleteBase=function(r,o,e,a){if("/"!=a){var i=this;this.getAppSignOnce(function(e){var t=i.getCgiUrl(a,e),n=new FormData;n.append("op","delete"),k.ajax({type:"POST",url:t,data:n,processData:!1,contentType:!1,success:r,error:o})})}else o({code:10003,message:"不能删除Bucket"})},e.prototype.getFolderStat=function(e,t,n,r){r=h(r,"folder"),this.statBase(e,t,n,r)},e.prototype.getFileStat=function(e,t,n,r){r=h(r),this.statBase(e,t,n,r)},e.prototype.statBase=function(n,r,e,o){var a=this;this.getAppSign.call(a,function(e){var t=a.getCgiUrl(o,e);k.ajax({url:t,type:"GET",data:{op:"stat"},success:n,error:r})})},e.prototype.createFolder=function(r,o,e,a,i){var s=this;this.getAppSign(function(e){a=h(a,"folder");var t=s.getCgiUrl(a,e),n=new FormData;n.append("op","create"),n.append("biz_attr",i||""),k.ajax({type:"POST",url:t,data:n,processData:!1,contentType:!1,success:r,error:o})})},e.prototype.copyFile=function(r,o,e,a,i,s){var c=this;this.getAppSign(function(e){a=h(a);var t=c.getCgiUrl(a,e),n=new FormData;n.append("op","copy"),n.append("dest_fileid",i),n.append("to_over_write",s),k.ajax({type:"POST",url:t,data:n,processData:!1,contentType:!1,success:r,error:o})})},e.prototype.moveFile=function(r,o,e,a,i,s){var c=this;this.getAppSign(function(e){a=h(a);var t=c.getCgiUrl(a,e),n=new FormData;n.append("op","move"),n.append("dest_fileid",i),n.append("to_over_write",s),k.ajax({type:"POST",url:t,data:n,processData:!1,contentType:!1,success:r,error:o})})},e.prototype.getFolderList=function(e,t,n,r,o,a,i,s,c){r=h(r,"folder"),this.listBase(e,t,n,r,o,a,i,s)},e.prototype.listBase=function(r,o,e,a,i,s,c,u,t){var l=this;l.getAppSign(function(e){var t=l.getCgiUrl(a,e),n={op:"list",num:i=i||20,context:s,order:c=c||0,pattern:u=u||"eListBoth"};k.ajax({url:t,type:"GET",data:n,success:r,error:o})})},e.prototype.uploadFile=function(r,e,o,t,a,i,s,n){var c=this;if(20971520<i.size)c.sliceUploadFile(r,e,o,t,a,i,s,void 0,void 0,n);else if("/"!==a.substr(a.length-1)){a=h(a);var u,l=d(),p={id:l,state:"uploading",cancel:function(){u&&u.abort()}};this.tasks[l]=p,n&&"function"==typeof n&&n(l),c.getAppSign(function(e){var t=c.getCgiUrl(a,e),n=new FormData;s=0===s?0:1,n.append("op","upload"),n.append("fileContent",i),n.append("insertOnly",s),u=k.ajax({type:"POST",url:t,data:n,processData:!1,contentType:!1,xhr:function(){var e=k.ajaxSettings.xhr();return e.upload.onprogress=function(e){var t=e.loaded/e.total;"function"==typeof o&&o(t,0)},e},success:function(){"cancel"!==p.state&&r.apply(this,arguments)},error:function(){"cancel"!==p.state&&r.apply(this,arguments)}})})}else e({code:-1,message:'path not allow end with "/"'})},e.prototype.sliceUploadFile=function(a,i,n,t,r,s,c,u,l,e){if("/"!==r.substr(r.length-1)){var o=d(),p={id:o,state:"uploading",cancelRequests:null,cancel:function(){p.cancelRequests&&p.cancelRequests()}};this.tasks[o]=p,e&&"function"==typeof e&&e(o);var f=this;r=h(r),f.getAppSign(function(e){var o={};o.globalTask=p,"cancel"!==o.globalTask.state&&(u=f.getSliceSize(u),o.bucket=t,o.path=r,o.file=s,o.insertOnly=0===c?0:1,o.sliceSize=u||1048576,o.appid=f.appid,o.sign=e,o.biz_attr=l||"",o.onprogress=function(e,t){void 0===t&&(t=1),n(e,t)},function(a){var r=this,i=k.Deferred(),s=a.file;return r.getAppSign(function(e){a.sign=e;var t=r.getCgiUrl(a.path,a.sign),n=new FormData;n.append("op","upload_slice_list"),k.ajax({type:"POST",dataType:"JSON",url:t,data:n,success:function(e){if(0==(e=e||{}).code){a.session=e.data.session,a.slice_size=e.data.slice_size;var t=e.data.listparts||[],n=(a.listparts=t).length;if(n){var r=a.listparts[n-1],o=r.offset;if(o+r.datalen>s.size)return i.resolve(),i.promise();a.offset=o}i.resolve(e)}else i.reject(e)},error:function(){i.reject()},processData:!1,contentType:!1})}),i.promise()}.call(f,o).always(function(e){if("cancel"!==o.globalTask.state){var t=(e=e||{}).data;if(t&&t.session){if(t.filesize!==o.file.size)return i({code:-1,message:"filesize not match"});var n=o.listparts||[];if(o.session=t.session,(o.listparts=n)&&n.length){var r=n.length;o.offset=n[r-1].offset}t.sha&&(o.onlineSha=t.sha.split("_")[0]),g.call(f,o).done(function(e){if("cancel"!==o.globalTask.state){var t=(o.uploadparts=e).length;o.sha=e[t-1].datasha,m.call(f,o).done(function(){v.call(f,o).done(function(e){a(e)}).fail(function(e){i({code:-1,message:e&&e.message||"slice finish error"})})}).fail(function(e){i({code:-1,message:e&&e.message||"slice upload file error"})})}}).fail(function(e){i({code:-1,message:e||"get slice sha1 error"})})}else t&&t.access_url&&0!==c?("function"==typeof o.onprogress&&o.onprogress(1,0),a(e)):g.call(f,o).done(function(e){if("cancel"!==o.globalTask.state){var t=(o.uploadparts=e).length;o.sha=e[t-1].datasha,function(s){var c=k.Deferred(),e=s.file,u=this,t=this.getCgiUrl(s.path,s.sign),n=new FormData,r=s.uploadparts;return n.append("uploadparts",JSON.stringify(r)),n.append("sha",s.sha),n.append("op","upload_slice_init"),n.append("filesize",e.size),n.append("slice_size",s.sliceSize),n.append("biz_attr",s.biz_attr),n.append("insertOnly",s.insertOnly),k.ajax({type:"POST",dataType:"JSON",url:t,data:n,success:function(e){if("cancel"!==s.globalTask.state)if(0==(e=e||{}).code){if(e.data.access_url)return void c.resolve(e);var t=e.data.session,n=parseInt(e.data.slice_size),r=e.data.offset||0;s.session=t,s.slice_size=n,s.offset=r,m.call(u,s).done(function(e){c.resolve(e)}).fail(function(e){c.reject(e)});for(var o,a={},i=1;i<s.uploadparts.length;i*=2)a[(o=s.uploadparts[i-1]).offset+"-"+o.datalen]=o.datasha;a[(o=s.uploadparts[s.uploadparts.length-1]).offset+"-"+o.datalen]=o.datasha,w(s.session,a,u.sha1CacheExpired)}else c.reject(e)},error:function(){c.reject()},processData:!1,contentType:!1}),c.promise()}.call(f,o).done(function(e){if("cancel"!==o.globalTask.state){var t=(e=e||{}).data||{};t&&t.access_url?("function"==typeof o.onprogress&&o.onprogress(1,0),a(e)):v.call(f,o).done(function(e){a(e)}).fail(function(e){i({code:-1,message:e.message||"slice finish error"})})}}).fail(function(e){i({code:(e=e||{}).code||-1,message:e.message||"upload slice file error"})})}}).fail(function(){i({code:-1,message:"get slice sha1 error"})})}}))})}else i({code:-1,message:'path not allow end with "/"'})},e.prototype.cancelTask=function(e){var t=this.tasks[e];t&&(t.state="cancel",t.cancel())};var c="_cos_sdk_sha1_",w=function(e,t,n){try{var r=JSON.parse(localStorage.getItem(c))||{}}catch(e){}var o=Date.now();t.update_time=o,r[e]=t;for(var a=localStorage.length-1;0<=a;a--){var i=localStorage.key(a),s=localStorage.getItem(i);o-s.update_time>n&&localStorage.removeItem(i)}localStorage.setItem(c,JSON.stringify(r))},r=function(e){try{var t=JSON.parse(localStorage.getItem(c))||{}}catch(e){}return t[e]},p=function(o,e,r){var a=this,i=new FormData,s=o.opt,t=s.file,n=s.slice_size,c=s.session,u=t.size,l=e.start,p=Math.min(l+n,u),f=a.slice.call(t,l,p),d=f.size,h=0,g=function(e,t){o.loadedSize+=e-h,h=e,o.onTaskProgress&&o.onTaskProgress(t)},m=function(r){i.append("sliceSize",n),i.append("op","upload_slice_data"),i.append("session",c),i.append("offset",l),s.sha&&i.append("sha",s.sha),i.append("fileContent",f),a.getAppSign(function(e){s.sign=e;var t=a.getCgiUrl(s.path,s.sign),n=k.ajax({type:"POST",dataType:"JSON",url:t,data:i,xhr:function(){var e=k.ajaxSettings.xhr();return e.upload.onprogress=function(e){g(e.loaded),o.onTaskProgress&&o.onTaskProgress()},e},success:function(e){g(d,!0),0===(e=e||{}).code?r(null,e):r("error",e)},error:function(){g(0,!0),r("error")},complete:function(){!function(e){for(var t=o.uploadingAjax.length-1;0<=t;t--)e===o.uploadingAjax[t]&&o.uploadingAjax.splice(t,1)}(n)},processData:!1,contentType:!1});o.uploadingAjax.push(n)})},v=function(n){"cancel"!==s.globalTask.state&&m(function(e,t){e?n>=a.uploadMaxRetryTimes||o.uploadError||"cancel"===s.globalTask.state?r(e,t):v(n+1):r(e,t)})};!function(e,t,n,r){var o;if(e.slice?o=e.slice(t,n):e.mozSlice?o=e.mozSlice(t,n):e.webkitSlice&&(o=e.webkitSlice(t,n)),b){var a=new FileReader;a.onload=function(e){r(new Blob([a.result]))},a.readAsArrayBuffer(o)}else r(o)}(t,l,p,function(e){d=(f=e).size,v(1)})};return e}()}),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}for(var c=e(function(e,t){function p(e){return Array.isArray(e)}function f(e){if(!e||"[object Object]"!==a.call(e))return!1;var t=o.call(e,"constructor"),n=e.constructor&&e.constructor.prototype&&o.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!n)return!1;var r=void 0;for(r in e);return void 0===r||o.call(e,r)}var o,a,d;e.exports=(o=Object.prototype.hasOwnProperty,a=Object.prototype.toString,d="function"==typeof Symbol&&"symbol"==s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)},function e(){var t=void 0,n=void 0,r=void 0,o=void 0,a=void 0,i=void 0,s=arguments[0],c=1,u=!1,l=arguments.length;for("boolean"==typeof s&&(u=s,s=arguments[1]||{},c=2),(null==s||"object"!==(void 0===s?"undefined":d(s))&&"function"!=typeof s)&&(s={});c<l;++c)if(null!=(t=arguments[c]))for(n in t)r=s[n],s!==(o=t[n])&&(u&&o&&(f(o)||(a=p(o)))?(i=a?(a=!1,r&&p(r)?r:[]):r&&f(r)?r:{},s[n]=e(u,i,o)):void 0!==o&&(s[n]=o));return s})}),u=[],l=0;l<256;++l)u[l]=(l+256).toString(16).substr(1);var p=function(e,t){var n=t||0,r=u;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")};var f=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||function(){return i.randomBytes(16)})();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[r+a]=o[a];return t||p(o)},d=e(function(e,t){(function(){var l=!1,i=function(e){return e instanceof i?e:this instanceof i?void(this.EXIFwrapped=e):new i(e)};e.exports&&(t=e.exports=i);var u=(t.EXIF=i).Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},p=i.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},f=i.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},d=i.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},h=i.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function o(e){return!!e.exifdata}function r(o,a){function t(e){var t=s(e);o.exifdata=t||{};var n=function(e){var t=new DataView(e);l&&console.log("Got file of length "+e.byteLength);if(255!=t.getUint8(0)||216!=t.getUint8(1))return l&&console.log("Not a valid JPEG"),!1;var n=2,r=e.byteLength;for(;n<r;){if(c=n,56===(s=t).getUint8(c)&&66===s.getUint8(c+1)&&73===s.getUint8(c+2)&&77===s.getUint8(c+3)&&4===s.getUint8(c+4)&&4===s.getUint8(c+5)){var o=t.getUint8(n+7);o%2!=0&&(o+=1),0===o&&(o=4);var a=n+8+o,i=t.getUint16(n+6+o);return m(e,a,i)}n++}var s,c}(e);if(o.iptcdata=n||{},i.isXmpEnabled){var r=function(e){if(!("DOMParser"in self))return;var t=new DataView(e);l&&console.log("Got file of length "+e.byteLength);if(255!=t.getUint8(0)||216!=t.getUint8(1))return l&&console.log("Not a valid JPEG"),!1;var n=2,r=e.byteLength,o=new DOMParser;for(;n<r-4;){if("http"==b(t,n,4)){var a=n-1,i=t.getUint16(n-2)-1,s=b(t,a,i),c=s.indexOf("xmpmeta>")+8,u=(s=s.substring(s.indexOf("<x:xmpmeta"),c)).indexOf("x:xmpmeta")+10;return s=s.slice(0,u)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+s.slice(u),S(o.parseFromString(s,"text/xml"))}n++}}(e);o.xmpdata=r||{}}a&&a.call(o)}if(o.src)if(/^data\:/i.test(o.src))t(function(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(e),r=n.length,o=new ArrayBuffer(r),a=new Uint8Array(o),i=0;i<r;i++)a[i]=n.charCodeAt(i);return o}(o.src));else if(/^blob\:/i.test(o.src)){(n=new FileReader).onload=function(e){t(e.target.result)},function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=function(e){200!=this.status&&0!==this.status||t(this.response)},n.send()}(o.src,function(e){n.readAsArrayBuffer(e)})}else{var e=new XMLHttpRequest;e.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";t(e.response),e=null},e.open("GET",o.src,!0),e.responseType="arraybuffer",e.send(null)}else if(self.FileReader&&(o instanceof self.Blob||o instanceof self.File)){var n;(n=new FileReader).onload=function(e){l&&console.log("Got file of length "+e.target.result.byteLength),t(e.target.result)},n.readAsArrayBuffer(o)}}function s(e){var t=new DataView(e);if(l&&console.log("Got file of length "+e.byteLength),255!=t.getUint8(0)||216!=t.getUint8(1))return l&&console.log("Not a valid JPEG"),!1;for(var n,r=2,o=e.byteLength;r<o;){if(255!=t.getUint8(r))return l&&console.log("Not a valid marker at offset "+r+", found: "+t.getUint8(r)),!1;if(n=t.getUint8(r+1),l&&console.log(n),225==n)return l&&console.log("Found 0xFFE1 marker"),a(t,r+4,t.getUint16(r+2));r+=2+t.getUint16(r+2)}}var g={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function m(e,t,n){for(var r,o,a,i,s=new DataView(e),c={},u=t;u<t+n;)28===s.getUint8(u)&&2===s.getUint8(u+1)&&(i=s.getUint8(u+2))in g&&((a=s.getInt16(u+3))+5,o=g[i],r=b(s,u+5,a),c.hasOwnProperty(o)?c[o]instanceof Array?c[o].push(r):c[o]=[c[o],r]:c[o]=r),u++;return c}function v(e,t,n,r,o){var a,i,s,c=e.getUint16(n,!o),u={};for(s=0;s<c;s++)a=n+12*s+2,!(i=r[e.getUint16(a,!o)])&&l&&console.log("Unknown tag: "+e.getUint16(a,!o)),u[i]=y(e,a,t,n,o);return u}function y(e,t,n,r,o){var a,i,s,c,u,l,p=e.getUint16(t+2,!o),f=e.getUint32(t+4,!o),d=e.getUint32(t+8,!o)+n;switch(p){case 1:case 7:if(1==f)return e.getUint8(t+8,!o);for(a=4<f?d:t+8,i=[],c=0;c<f;c++)i[c]=e.getUint8(a+c);return i;case 2:return b(e,a=4<f?d:t+8,f-1);case 3:if(1==f)return e.getUint16(t+8,!o);for(a=2<f?d:t+8,i=[],c=0;c<f;c++)i[c]=e.getUint16(a+2*c,!o);return i;case 4:if(1==f)return e.getUint32(t+8,!o);for(i=[],c=0;c<f;c++)i[c]=e.getUint32(d+4*c,!o);return i;case 5:if(1==f)return u=e.getUint32(d,!o),l=e.getUint32(d+4,!o),(s=new Number(u/l)).numerator=u,s.denominator=l,s;for(i=[],c=0;c<f;c++)u=e.getUint32(d+8*c,!o),l=e.getUint32(d+4+8*c,!o),i[c]=new Number(u/l),i[c].numerator=u,i[c].denominator=l;return i;case 9:if(1==f)return e.getInt32(t+8,!o);for(i=[],c=0;c<f;c++)i[c]=e.getInt32(d+4*c,!o);return i;case 10:if(1==f)return e.getInt32(d,!o)/e.getInt32(d+4,!o);for(i=[],c=0;c<f;c++)i[c]=e.getInt32(d+8*c,!o)/e.getInt32(d+4+8*c,!o);return i}}function b(e,t,r){var o="";for(n=t;n<t+r;n++)o+=String.fromCharCode(e.getUint8(n));return o}function a(e,t){if("Exif"!=b(e,t,4))return l&&console.log("Not valid EXIF data! "+b(e,t,4)),!1;var n,r,o,a,i,s=t+6;if(18761==e.getUint16(s))n=!1;else{if(19789!=e.getUint16(s))return l&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;n=!0}if(42!=e.getUint16(s+2,!n))return l&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var c=e.getUint32(s+4,!n);if(c<8)return l&&console.log("Not valid TIFF data! (First offset less than 8)",e.getUint32(s+4,!n)),!1;if((r=v(e,s,s+c,p,n)).ExifIFDPointer)for(o in a=v(e,s,s+r.ExifIFDPointer,u,n)){switch(o){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":a[o]=h[o][a[o]];break;case"ExifVersion":case"FlashpixVersion":a[o]=String.fromCharCode(a[o][0],a[o][1],a[o][2],a[o][3]);break;case"ComponentsConfiguration":a[o]=h.Components[a[o][0]]+h.Components[a[o][1]]+h.Components[a[o][2]]+h.Components[a[o][3]]}r[o]=a[o]}if(r.GPSInfoIFDPointer)for(o in i=v(e,s,s+r.GPSInfoIFDPointer,f,n)){switch(o){case"GPSVersionID":i[o]=i[o][0]+"."+i[o][1]+"."+i[o][2]+"."+i[o][3]}r[o]=i[o]}return r.thumbnail=function(e,t,n,r){var o=function(e,t,n){var r=e.getUint16(t,!n);return e.getUint32(t+2+12*r,!n)}(e,t+n,r);if(!o)return{};if(o>e.byteLength)return{};var a=v(e,t,t+o,d,r);if(a.Compression)switch(a.Compression){case 6:if(a.JpegIFOffset&&a.JpegIFByteCount){var i=t+a.JpegIFOffset,s=a.JpegIFByteCount;a.blob=new Blob([new Uint8Array(e.buffer,i,s)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",a.Compression)}else 2==a.PhotometricInterpretation&&console.log("Thumbnail image format is RGB, which is not implemented.");return a}(e,s,c,n),r}function w(e){var t={};if(1==e.nodeType){if(0<e.attributes.length){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var r=e.attributes.item(n);t["@attributes"][r.nodeName]=r.nodeValue}}}else if(3==e.nodeType)return e.nodeValue;if(e.hasChildNodes())for(var o=0;o<e.childNodes.length;o++){var a=e.childNodes.item(o),i=a.nodeName;if(null==t[i])t[i]=w(a);else{if(null==t[i].push){var s=t[i];t[i]=[],t[i].push(s)}t[i].push(w(a))}}return t}function S(e){try{var t={};if(0<e.children.length)for(var n=0;n<e.children.length;n++){var r=e.children.item(n),o=r.attributes;for(var a in o){var i=o[a],s=i.nodeName,c=i.nodeValue;void 0!==s&&(t[s]=c)}var u=r.nodeName;if(void 0===t[u])t[u]=w(r);else{if(void 0===t[u].push){var l=t[u];t[u]=[],t[u].push(l)}t[u].push(w(r))}}else t=e.textContent;return t}catch(e){console.log(e.message)}}i.enableXmp=function(){i.isXmpEnabled=!0},i.disableXmp=function(){i.isXmpEnabled=!1},i.getData=function(e,t){return!((self.Image&&e instanceof self.Image||self.HTMLImageElement&&e instanceof self.HTMLImageElement)&&!e.complete)&&(o(e)?t&&t.call(e):r(e,t),!0)},i.getTag=function(e,t){if(o(e))return e.exifdata[t]},i.getIptcTag=function(e,t){if(o(e))return e.iptcdata[t]},i.getAllTags=function(e){if(!o(e))return{};var t,n=e.exifdata,r={};for(t in n)n.hasOwnProperty(t)&&(r[t]=n[t]);return r},i.getAllIptcTags=function(e){if(!o(e))return{};var t,n=e.iptcdata,r={};for(t in n)n.hasOwnProperty(t)&&(r[t]=n[t]);return r},i.pretty=function(e){if(!o(e))return"";var t,n=e.exifdata,r="";for(t in n)n.hasOwnProperty(t)&&("object"==typeof n[t]?n[t]instanceof Number?r+=t+" : "+n[t]+" ["+n[t].numerator+"/"+n[t].denominator+"]\r\n":r+=t+" : ["+n[t].length+" values]\r\n":r+=t+" : "+n[t]+"\r\n");return r},i.readFromBinaryFile=function(e){return s(e)}}).call(r)});function h(){}var g=(t(m,[{key:"compress",value:function(e,t,n,r,o,a){var i=2<arguments.length&&void 0!==n?n:1,s=r,c=o,u=a;return/^image/.test(e.type)?this.compressImage(e,t,i,s,c,u):t}},{key:"compressImage",value:function(e,t,n,r,o,a){var s=2<arguments.length&&void 0!==n?n:1,c=3<arguments.length&&void 0!==r?r:5,u=4<arguments.length&&void 0!==o?o:0,l=5<arguments.length&&void 0!==a?a:0,p=new Image;p.src=t;var f=null;return d.getData(e,function(){f=d.getTag(this,"Orientation")}),new Promise(function(i,e){p.onload=function(){var e=p.width,t=p.height,n=void 0,r=void 0;n=parseInt(e/c,10),r=parseInt(t/c,10),n<u&&(c=e/u),r<l&&(c=t/l),n=parseInt(e/c,10),r=parseInt(t/c,10);var o=document.createElement("canvas"),a=o.getContext("2d");if(o.width=n,o.height=r,f&&1!=f)switch(f){case 6:o.width=r,o.height=n,a.rotate(Math.PI/2),a.drawImage(this,0,-r,n,r);break;case 3:a.rotate(Math.PI),a.drawImage(this,-n,-r,n,r);break;case 8:o.width=r,o.height=n,a.rotate(3*Math.PI/2),a.drawImage(this,-n,0,n,r)}else a.drawImage(this,0,0,n,r);i(o.toDataURL("image/jpeg",s))},p.onerror=function(){e("加载图片失败")}})}},{key:"createPreview",value:function(n,e,t,r,o){var a=1<arguments.length&&void 0!==e?e:.6,i=t,s=r,c=o;if(!n||!window.FileReader)return Promise.resolve();if(/^image/.test(n.type)){var u=new FileReader;u.readAsDataURL(n);var l=this;return new Promise(function(e,t){u.onload=function(){e(l.compress(n,this.result,a,i,s,c))},u.onerror=function(){t(this.error.toString())}})}if(/^video/.test(n.type)){var p=function(e){var t=null;return null!=window.createObjectURL?t=window.createObjectURL(e):null!=window.URL?t=window.URL.createObjectURL(e):null!=window.webkitURL&&(t=window.webkitURL.createObjectURL(e)),t}(n);return Promise.resolve(p)}return Promise.resolve()}},{key:"toBlob",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:"image/jpeg";e=e.split(",")[1],e=window.atob(e);for(var r=new Uint8Array(e.length),o=0,a=e.length;o<a;o++)r[o]=e.charCodeAt(o);return Blob=window.Blob||window.WebkitBlob,new Blob([r],{type:n})}},{key:"doUpload",value:function(e,t,n,r){var o=1<arguments.length&&void 0!==t?t:"act/initial-image/",a=n,i=r;if(!this.cos||!e)return Promise.resolve();var s=o+this.getFileName(e),c=/^image/.test(e.type)?this.toBlob(a,e.type):e;return this.cosUpload(c,s,i)}},{key:"cosUpload",value:function(e,r,t){var o=this,a=2<arguments.length&&void 0!==t?t:h;return new Promise(function(t,n){o.cos.uploadFile(function(e){0==e.code?t(e.data.source_url):n(e.message)},function(e){"SUCCESS"!=e&&n(e.responseText)},a,o.options.bucket,r,e)})}},{key:"getFileName",value:function(e){return f()+e.name}},{key:"init",value:function(e){var t=this;c(this.options,e),this.cos=new o({appid:this.options.appid,bucket:this.options.bucket,region:"sh",getAppSign:function(e){e(t.options.authorization)}})}},{key:"destroy",value:function(){this.cos=null}}]),m);function m(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),this.options={appid:"",bucket:""},this.init(e)}return function(e){return new g(e)}});
