!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ImgPreview=t()}(this,function(){"use strict";var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},n={max:8,callback:function(){},fileType:""};return function(){function o(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e(this,o),this.files=t,this.options=i({},n,r),!t)throw new Error("files参数不能为空");this.collectFiles()}return t(o,[{key:"collectFiles",value:function(){var e=this.files.length,t=this.options;e=e<=t.max?e:t.max;for(var i=0;i<e;i++){var n=this.files[i];/^image\/*/.test(n.type)&&this.previewImage(n,i)}}},{key:"previewImage",value:function(e,t){var i=this.options,n=+new Date+String(t),o=null;void 0!==window.createObjectURL?o=window.createObjectURL(e):void 0!==window.URL?o=window.URL.createObjectURL(e):void 0!==window.webkitURL&&(o=window.webkitURL.createObjectURL(e)),i.callback(o,n,i.fileType)}},{key:"compressImage",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8;this.revokeObject(e);var o=t.naturalWidth,r=t.naturalHeight,a=parseInt(o/i,10),l=parseInt(r/i,10),c=document.createElement("canvas"),w=c.getContext("2d");return c.width=a,c.height=l,w.fillStyle="#fff",w.fillRect(0,0,c.width,c.height),w.drawImage(t,0,0,a,l),c.toDataURL("image/jpeg",n)}},{key:"revokeObject",value:function(e){void 0!==window.revokeObjectURL?window.revokeObjectURL(e):void 0!==window.URL?window.URL.revokeObjectURL(e):void 0!==window.webkitURL&&window.webkitURL.revokeObjectURL(e)}}],[{key:"convertBase64UrlToBlob",value:function(e){for(var t=e.split(","),i=t[0].match(/:(.*?);/)[1],n=atob(t[1]),o=n.length,r=new Uint8Array(o);o--;)r[o]=n.charCodeAt(o);var a=window.BlobBuilder||window.WebKitBlobBuilder,l=void 0;if(a){var c=new a;c.append(r),l=c.getBlob(i)}else l=new(window.Blob||window.WebkitBlob)([r],{type:i});return l}}]),o}()});
