!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Validate=t()}(this,function(){"use strict";function e(e,a){if(!n(a))throw new Error("cb must be a function.");if(Array.isArray(e))for(var r=0,i=e.length;r<i&&!1!==a(r,e[r]);r++);else if(t(e))for(var c in e)if(o.call(e,c)&&!1===a(c,e[c]))break}function t(e){return"[object Object]"===i.call(e)}function n(e){return"function"==typeof e}function a(e){return"[object String]"===i.call(e)}function r(e){return"string"==typeof e?document.querySelector(e):e}var i=Object.prototype.toString,o=Object.prototype.hasOwnProperty,c=[{name:"required",callback:function(e,t,n){var a=e.tagName,r=[];return""===t?r.push(n.errMsg||"您输入的"+n.itemName+"不能为空"):"SELECT"!==a||n.reg.test(t)||r.push(n.errMsg||"请选择"+n.itemName),r}},{name:"format",callback:function(e,t,n){var a=[];return n.reg.test(t)||a.push(n.errMsg||"您输入的"+n.itemName+"格式有误"),a}},{name:"length",callback:function(e,t,n){var a=[],r=t.length;return n.dByte&&(r=t.replace(/[\u0391-\uFFE5]/g,"__").length),n.maxLen&&r>n.maxLen?a.push(n.errMsg||"您输入的"+n.itemName+"超过"+n.maxLen+"个字符"):n.minLen&&r<n.minLen&&a.push(n.errMsg||"您输入的"+n.itemName+"不足"+n.minLen+"个字符"),a}},{name:"range",callback:function(e,t,n){var a=[];return(n.minVal&&t<n.minVal||n.maxVal&&t>n.maxVal)&&a.push(n.errMsg||"请输入"+n.minVal+"-"+n.maxVal+"的数字"),a}},{name:"compare",callback:function(e,t,n){var a=[];return n.compareWith&&(this.cacheNodes[n.compareWith]||r(n.compareWith)).value.trim()!==t&&a.push(n.errMsg||"两次输入的"+n.itemName+"不一致"),a}}],u=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();return function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];u(this,t),this.rules=e,this.validators={},this.cacheNodes={},this._init()}return l(t,[{key:"_init",value:function(){var e=this;c.forEach(function(t){e.addValidator(t.name,t.callback)})}},{key:"addValidator",value:function(e,t){if(this.validators[e])throw new Error("名称为"+e+"的校验器已经存在");this.validators[e]=t}},{key:"getRealNode",value:function(e){return a(e)?this.cacheNodes[e]?e=this.cacheNodes[e]:(this.cacheNodes[e]=r(e),e=this.cacheNodes[e]):e=r(e),e}},{key:"validate",value:function(){var t=this,n=[];return this.rules.forEach(function(a){var r=t.getRealNode(a.node),i=a.validators||[],o=r.value.trim(),c=[];e(i,function(e,n){var a=n.name,i=n.options,u=t.validators[a];return!u||0===(c=c.concat(u.call(t,r,o,i||{})||[])).length}),n=n.concat(c),a.callback&&a.callback(r,c)}),n}}]),t}()});
