!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Tracker=n()}(this,function(){"use strict";function e(e,t){var r=window.onerror;window.onerror=function(){var e=Array.prototype.slice.call(arguments);r&&r.apply(window,e);var o=n.apply(window,e);return!(o.msg.indexOf("Script error")>-1&&!o.url)&&(t&&t(o),!0)}}function n(e,n,t,r,o){var i="";if(y.ie){var a=window.event;e=e||a.errorMessage,n=n||a.errorUrl,t=t||a.errorLine,r=r||a.errorCharacter}else n=n||o&&o.fileName||"",t=t||o&&o.lineNumber||"",r=r||o&&o.columnNumber||"",i=o&&o.stack||"";return{msg:e,url:n,line:t,col:r,stack:i.toString()}}function t(e,n,t){if(e+="",(n-=e.length)<=0)return e;if(t||0===t||(t=" ")," "===(t+="")&&n<10)return _[n]+e;for(var r="";;){if(1&n&&(r+=t),!(n>>=1))break;t+=t}return r+e}function r(e){var n=arguments[1]||window.location.search.replace("&amp;","&"),t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),r=n.substr(n.indexOf("?")+1).match(t);return null!=r?r[2]:""}function o(e){var n=new RegExp("(^| )"+e+"(?:=([^;]*))?(;|$)"),t=document.cookie.match(n);return t?t[2]?unescape(t[2]):"":null}function i(){var e="";return y.android?e="android":y.ios&&(e="ios"),e}function a(e){return e=e||"g_tracker",String(Math.random()+Math.random()).replace(b,e)}function c(){return k||(y.jyb&&"undefined"!=typeof wv?wv.ready(function(){wv.getNetworkType({complete:function(e){k=e.networkType}})}):navigator.connection&&(k=navigator.connection.type||""),k||"")}function s(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}}function u(){var e=new Date;return e.getFullYear()+"-"+t(e.getMonth()+1,2,"0")+"-"+t(e.getDate(),2,"0")+" "+t(e.getHours(),2,"0")+":"+t(e.getMinutes(),2,"0")+":"+t(e.getSeconds(),2,"0")}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={link:location.href,ua:navigator.userAgent,title:document.title,size:document.documentElement.clientWidth+"*"+document.documentElement.clientHeight,referer:document.referer||"",timestamp:(new Date).getTime(),network:c(),badjs:O.BAD_JS,pid:e.pid},o=P(t,n),a=A[e.env]||"",s={ak:$,body:JSON.stringify({cmd:x,data:[{sid:"",op_type:"error",op_result:"",op_time:u(),op_object:"",op_page:"",op_params:P({platform:i(),in_app:y.jyb?1:0,cust_id:D,uniq_id:D||I,source:r("channel")||r("from")||"",act_id:"",group:""},o)}]})},l=[];for(var f in s)l.push(f+"="+encodeURIComponent(s[f]));e.debug?console.log(JSON.stringify(o,null,2)):d(a+"?"+l.join("&"))}function d(e){var n=a(),t=new Image;window[n]||(window[n]=t,t.onload=t.onerror=function(){window[n]=null,delete window[n]}),t.src=e}function f(e){var n=["msg","line","col","url","errStack"];return n.forEach(function(n){e[n]||(e[n]="")}),e.c1=[e.msg,e.line,e.col].join(","),e.c2=e.url,e.c3=e.errStack,n.forEach(function(n){return delete e[n]}),e}var p=window.navigator.userAgent,m=p.match(/(Android);?[\s\/]+([\d.]+)?/),h=p.match(/(iPad).*OS\s([\d_]+)/),v=p.match(/(iPod)(.*OS\s([\d_]+))?/),g=!h&&p.match(/(iPhone\sOS)\s([\d_]+)/),w=/jiayoubao/.test(p.toLowerCase()),y={};y.jyb=w,y.ie="ActiveXObject"in window,m&&(y.android=!0,y.version=m[2]),g&&!v&&(y.ios=y.iphone=!0,y.version=g[2].replace(/_/g,".")),h&&(y.ios=y.ipad=!0,y.version=h[2].replace(/_/g,".")),v&&(y.ios=y.ipod=!0,y.version=v[3]?v[3].replace(/_/g,"."):null);var _=[""," ","  ","   ","    ","     ","      ","       ","        ","         "],b=/\d\.\d{4}/,E="__TRACKER_UUID__",k="";c();var S={JS_ERROR:"1",API_ERROR:"2"},O={BAD_JS:"1"},j=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},R=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),P=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},A={test:"//172.16.1.16:8890",prod:"//report.jyblife.com"},$="KVQiUTJf",x="65010000",D=r("userid")||o("userid")||"",I=function(){try{var e=window.localStorage.getItem(E);return e||(e=a(),window.localStorage.setItem(E,e)),e}catch(e){return a()}}(),J=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};j(this,n),this.$options=e,this.params=P({t_type:S.JS_ERROR},t),this._init()}return R(n,[{key:"_init",value:function(){var n=this;this.$options.collectWindowErrors&&e(this.$options,function(e){n._send(e)})}},{key:"_send",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this.$options,f(P({},this.params,e)))}},{key:"captureError",value:function(e,n){s(e)&&this._send(P({msg:(e.name||"")+": "+(e.message||""),errStack:(e.stack||"").toString()},n))}}]),n}(),T={pid:function(){var e=window.location.href,n=e.slice(e.indexOf("://")+3).split(/\/+/);return n.length>2?n[1]:""}(),debug:!1,collectWindowErrors:!0,env:"prod",commonParams:null},C=function(){function e(){j(this,e),this.$options={},this.commonParams={},this.inited=!1}return R(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.inited||(this.$options=P({},T,e),this.commonParams=this.$options.commonParams||{},this.initError(),this.inited=!0)}},{key:"log",value:function(e){if(!this.inited)throw new Error("必须先初始化");l(this.$options,P({},this.commonParams,e))}},{key:"captureApi",value:function(e){this.log(P({t_type:S.API_ERROR},e))}},{key:"initError",value:function(){var e=new J(this.$options,this.commonParams);this.error=e,this.Error=J,this.captureError=e.captureError.bind(e)}}]),e}(),M=new C;return M.Ctor=C,M});
